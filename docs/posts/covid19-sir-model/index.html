<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="/svg/avatar.svg">
    <title>
        
Analysis of basic Epidemiological models - Part 1

    </title>

    

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,500;0,900;1,100;1,500;1,900&display=swap" rel="stylesheet">


<script src="https://code.jquery.com/jquery-3.7.0.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>


<script src="https://kit.fontawesome.com/ca14d5004b.js" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css">




<link rel="stylesheet" type="text/css" href="/css/index.436ec3c9a53aac3c4f341e072d082ee0.css" />





<link rel="stylesheet" href="/css/paginatorStyle.css">


<script src="https://unpkg.com/typed.js@2.0.16/dist/typed.umd.js"></script>


<style>
  html {
      scroll-behavior: smooth;
  }
</style>



<script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>

     
     
</head>
<body>
    <div class="app-container min-h-[100vh] flex flex-col justify-between">
        <nav class="bg-white shadow-xl z-50">
    
    <div class="hidden mx-auto max-w-7xl py-2 px-4 md:px-6 lg:px-8 md:flex flex-row items-center">
        <div class="w-[200px] flex items-center">
            <a class="uppercase font-extrabold font-mono text-2xl flex flex-row justify-center items-center gap-2"> 
                <img src="/images/logo-wide.png" class="h-[75px] inline-block" />    
            </a>
        </div>
        <div class="w-full flex flex-row justify-center items-center gap-4">
            
                <a href="/" class="px-4 py-2 border rounded-lg hover:bg-gray-100">
                    Home
                </a>
            
                <a href="/posts" class="px-4 py-2 border rounded-lg hover:bg-gray-100">
                    Posts
                </a>
            
                <a href="/aboutme" class="px-4 py-2 border rounded-lg hover:bg-gray-100">
                    About Me
                </a>
            
                <a href="/#contact-me" class="px-4 py-2 border rounded-lg hover:bg-gray-100">
                    Contact Me
                </a>
            
        </div>
        <div class="w-[200px] flex flex-row justify-around items-center">
            
                <a href="mailto:subhrajyotyroy@gmail.com" class="hover:text-gray-600 transition-all ease-in-out">
                    <i class = "fas fa-envelope fa-lg"></i>
                </a>
            
                <a href="https://www.facebook.com/subroy13/" class="hover:text-gray-600 transition-all ease-in-out">
                    <i class = "fab fa-facebook fa-lg"></i>
                </a>
            
                <a href="https://github.com/subroy13" class="hover:text-gray-600 transition-all ease-in-out">
                    <i class = "fab fa-github fa-lg"></i>
                </a>
            
                <a href="#" class="hover:text-gray-600 transition-all ease-in-out">
                    <i class = "fab fa-linkedin-in fa-lg"></i>
                </a>
            
                <a href="#" class="hover:text-gray-600 transition-all ease-in-out">
                    <i class = "fab fa-instagram fa-lg"></i>
                </a>
            
        </div>
    </div>

    
    <div class="flex py-4 px-2 max-w-7xl flex-row justify-end items-center md:hidden">
        <div class="w-full flex justify-center items-center">
            <p class="uppercase font-extrabold font-mono text-2xl">
                StatWizard
            </p>
        </div>
        <div class="w-[30px] mr-4 relative">
            <button type="button"
                id="mobile-menu-button"
                class="inline-flex items-center justify-center rounded-md p-2 text-gray-400 hover:bg-gray-700 hover:text-white focus:outline-none"
                aria-controls="mobile-menu" aria-expanded="false">
                <span class="sr-only">Open main menu</span>
                    
                    <svg id="mobile-menu-close-icon" class="bg-white text-neutral-800 outline-none block h-6 w-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
                        aria-hidden="true">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
                    </svg>
                
                <svg id="mobile-menu-open-icon" class="bg-white text-neutral-800 outline-none hidden h-6 w-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
                    aria-hidden="true">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                </svg>
            </button>

            <div id="mobile-menu" class="absolute end-0 mt-4 -mr-4 bg-white w-[90vw] hidden">
                <ul class="flex flex-col">
                    
                        <li class="px-4 sm:px-8 py-2 border first:rounded-t-lg last:rounded-b-lg hover:bg-gray-100">
                            <a href="/" class="">
                                Home
                            </a>
                        </li>
                    
                        <li class="px-4 sm:px-8 py-2 border first:rounded-t-lg last:rounded-b-lg hover:bg-gray-100">
                            <a href="/posts" class="">
                                Posts
                            </a>
                        </li>
                    
                        <li class="px-4 sm:px-8 py-2 border first:rounded-t-lg last:rounded-b-lg hover:bg-gray-100">
                            <a href="/aboutme" class="">
                                About Me
                            </a>
                        </li>
                    
                        <li class="px-4 sm:px-8 py-2 border first:rounded-t-lg last:rounded-b-lg hover:bg-gray-100">
                            <a href="/#contact-me" class="">
                                Contact Me
                            </a>
                        </li>
                    
                </ul>
            </div>
        </div>
    </div>
</nav>


        <div class="content-container">
            



    <div class="relative h-[33vh] max-h-[300px] w-full bg-cover bg-center bg-no-repeat bg-fixed rounded-b-md" 
        style = "background-image: url('/posts/covid19-sir-model/featured.jpg')">
        
            <div class = "absolute top-0 left-0 bg-neutral-800/100 w-fit text-white p-1 ml-1 font-xs rounded-md">
                <p>Cover image taken from <a href="https://edition.cnn.com/2020/03/24/world/coronavirus-newsletter-03-24-20/index.html">CNN.com</a></p>
            </div>
        
    </div>



<div class="flex flex-col gap-4 mx-4 px-8">
    <h1 class="text-3xl text-center text-neutral-600 font-bold md:px-8 md:pt-6">
        Analysis of basic Epidemiological models - Part 1
    </h1>
    <div class="m-2 p-4 rounded-lg shadow-lg border-2 grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="flex flex-col justify-center items-center gap-2">   
            <div class="mt-1 flex flex-row text-neutral-800 gap-4">
                <p class="font-bold">Date:</p>
                <p class="font-normal">25 March, 2020</p>
            </div> 
            <p class="mt-1 text-neutral-600">
                <span class="font-bold">14</span> minutes read
            </p>
            <div class="my-1">
                
                    <a href="/tags/epidemiology/" 
                        class = "inline-block bg-gray-200 rounded-full px-3 py-1 text-sm font-base text-gray-700 mr-2 mb-2
                        hover:underline hover:bg-gray-300 transition ease-in-out">
                        Epidemiology
                    </a>
                
            </div>    
        </div>
        <div class="flex flex-col justify-center gap-2">
            <div class="">
                <h2 class="text-neutral-900 font-bold">
                    Important Links:
                </h2>
                
                    
                        <div class="px-2 mt-1 rounded-sm bg-success-100 text-success-800">
                            <i class = "fas fa-database"></i> <a href="https://github.com/CSSEGISandData/COVID-19" class = "text-success-800 hover:text-black hover:underline cursor-pointer" target="_blank" >JHU CSSE Dataset</a>
                        </div>
                    
                
            </div>
        </div>
    </div>
    <div class="grid grid-cols-1 md:grid-cols-4 gap-2">
        <div class="relative col-span-1">
            <div class="sticky top-0 left-0 w-full pl-4 pt-4">
                <h1 class="text-bold text-xl">Table of Contents</h1>
                <div class="prose">
                    <nav id="TableOfContents">
  <ul>
    <li><a href="#estimation-for-hong-kong-china">Estimation for Hong Kong, China</a></li>
    <li><a href="#performance-for-india">Performance for India</a></li>
    <li><a href="#predictions-till-the-end-of-the-lockdown">Predictions till the end of the Lockdown</a></li>
  </ul>
</nav>
                </div>
            </div>
        </div>
        <div class="col-span-3">
            <div class="text-justify break-words w-full">
                <div class="prose" style="max-width: none;">
                    <h1 id="the-current-global-scenario">The Current Global Scenario</h1>
<p>At the end of December 2019, a cluster of an unknown pneumonia like cases were reported in Wuhan, a city in the Hubei province, China. They quickly identified that the source of the infection was a novel coronavirus belonging to the coronavirus family, which includes the virus related to the outbreaks of  Severe Acute Respiratory Syndrome (SARS) from 2002-2004 and Middle East Respiratory Syndrome (MERS) in 2012. It  spread through and outside of Wuhan, resulting in an rapidly escalating and deadly contagious epidemic throughout China, followed by an increasing number of cases in other countries throughout the world.<br>
On January 30, the WHO declared coronavirus a global emergency  as the death toll in China jumped to 170, with 7,711 cases reported in the country, where the virus had spread to all 31 provinces.  In mid-February WHO announced that the new coronavirus would be called &ldquo;COVID-19&rdquo;.</p>
<p>China&rsquo;s bold approach to contain the rapid spread of this new respiratory pathogen  by massive lockdowns and electronic surveillance measures has changed the changed the course of the epidemic . The number of new infections reported in China has been declining gradually. With over 422,915 reported cases and more than 18,543 recorded deaths worldwide , the outbreak of COVID-19 has surpassed the toll of the 2002-2003 SARS outbreak, which also originated in China and is expected to continue to increase.  Although the infection originated in China, now the epicenter of the pandemic is Europe, which now has more cases reported each day than China did at the height of its outbreak.  In Italy alone the COVID-19 has infected more than 69,000 people and killed at least 6,800. There is an increasing number of cases in several EU/EEA countries without epidemiological links to explain the source of transmission. The speed with which COVID-19 can cause nationally incapacitating epidemics once transmission within the community is established indicates that it is likely that in a few weeks or even days, similar situations to those seen in China and Italy may be seen in other EU/EEA countries or the UK, as more countries report evidence of community transmission.
The COVID-19 virus spreads primarily through droplets of saliva or discharge from the nose when an infected person coughs or sneezes.  At the time of this writing, there are no specific vaccines or treatments for COVID-19 which is generally accepted.</p>
<h1 id="introduction">Introduction</h1>
<p>This is a project to give ourselves a basic understanding of statistical modelling of epidemiology. In past few days of Shelter-in-place lockdown situation in Kolkata (and throughout the whole India from today onwards), me and one of my ingenious friend <a href="https://soham01.netlify.com/">Soham Bonnerjee</a>, was reading about different epidemiological models available in the literature and using it to generate projections for the number of infected people in India. In this first part, we shall explore the performance of deterministic SIR model which to be fitted using a least squares procedure. Then, we shall use it to generate projections for the epidemic situation in India, till the end of this lockdown, which is currently annouced to be remain till April 14, 2020, about 3 weeks from today.</p>
<h1 id="exploratory-analysis">Exploratory Analysis</h1>
<p>Before proceeding with introducing the SIR model, let us first read the data into <code>R</code> (which is what we are going to use through out), and perform some exploratory analysis. We shall be using the <a href="https://www.tidyverse.org/">tidyverse</a> library, which is a collection of some very useful packages for data proprocessing and exploratory analysis.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(readr)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(dplyr)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(tidyr)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(lubridate)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(ggplot2)
</span></span></code></pre></div><p>For the related coronavirus, there are may different sources available. Many international organizations like WHO (World Health Organization), ECDC (European Centre for Disease Prevention and Control) and many national governments are releasing day to day basis publicly available data. As well as different news agencies are also collecting and compileing data from the hospitals and different other sources on a regular basis. John Hopkins University (JHU) CSSE department has also released a dataset compiled from the collection of these sources in a github repository <a href="https://github.com/CSSEGISandData/COVID-19">here</a>.</p>
<p>The datasets are being updated on a daily basis. We shall use this data provided by <a href="https://github.com/CSSEGISandData/COVID-19">JHU CSSE</a>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>confirmed.dat <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">read_csv</span>(<span style="color:#e6db74">&#39;./datasets/time_series_19-covid-Confirmed.csv&#39;</span>)
</span></span><span style="display:flex;"><span>deaths.dat <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">read_csv</span>(<span style="color:#e6db74">&#39;./datasets/time_series_19-covid-Deaths.csv&#39;</span>)
</span></span><span style="display:flex;"><span>recovered.dat <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">read_csv</span>(<span style="color:#e6db74">&#39;./datasets/time_series_19-covid-Recovered.csv&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>confirmed.dat <span style="color:#f92672">&lt;-</span> confirmed.dat <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">rename</span>( State <span style="color:#f92672">=</span> `Province/State`, Country <span style="color:#f92672">=</span> `Country/Region` ) <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">gather</span>(key <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Date&#34;</span>, value <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Confirmed&#34;</span>, <span style="color:#f92672">-</span><span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">4</span>) ) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mutate</span>(Date <span style="color:#f92672">=</span> <span style="color:#a6e22e">mdy</span>(Date))
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>deaths.dat <span style="color:#f92672">&lt;-</span> deaths.dat <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">rename</span>( State <span style="color:#f92672">=</span> `Province/State`, Country <span style="color:#f92672">=</span> `Country/Region` ) <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">gather</span>(key <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Date&#34;</span>, value <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Deaths&#34;</span>, <span style="color:#f92672">-</span><span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">4</span>) ) <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mutate</span>(Date <span style="color:#f92672">=</span> <span style="color:#a6e22e">mdy</span>(Date))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>recovered.dat <span style="color:#f92672">&lt;-</span> recovered.dat <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">rename</span>( State <span style="color:#f92672">=</span> `Province/State`, Country <span style="color:#f92672">=</span> `Country/Region` ) <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">gather</span>(key <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Date&#34;</span>, value <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Recovered&#34;</span>, <span style="color:#f92672">-</span><span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">4</span>) ) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mutate</span>(Date <span style="color:#f92672">=</span> <span style="color:#a6e22e">mdy</span>(Date))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># merge all of them together</span>
</span></span><span style="display:flex;"><span>dat <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">Reduce</span>(merge, <span style="color:#a6e22e">list</span>(confirmed.dat, deaths.dat, recovered.dat))
</span></span><span style="display:flex;"><span>dat <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">as_tibble</span>(dat)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>knitr<span style="color:#f92672">::</span><span style="color:#a6e22e">kable</span>(<span style="color:#a6e22e">head</span>(dat, <span style="color:#ae81ff">5</span>))
</span></span></code></pre></div><table>
<thead>
<tr>
<th>State</th>
<th>Country</th>
<th>Lat</th>
<th>Long</th>
<th>Date</th>
<th>Confirmed</th>
<th>Deaths</th>
<th>Recovered</th>
</tr>
</thead>
<tbody>
<tr>
<td>Adams, IN</td>
<td>US</td>
<td>39.8522</td>
<td>-77.2865</td>
<td>2020-01-22</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>Adams, IN</td>
<td>US</td>
<td>39.8522</td>
<td>-77.2865</td>
<td>2020-01-23</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>Adams, IN</td>
<td>US</td>
<td>39.8522</td>
<td>-77.2865</td>
<td>2020-01-24</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>Adams, IN</td>
<td>US</td>
<td>39.8522</td>
<td>-77.2865</td>
<td>2020-01-25</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>Adams, IN</td>
<td>US</td>
<td>39.8522</td>
<td>-77.2865</td>
<td>2020-01-26</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>
<p>Now we shall try to see how the total number of Confirmed, deaths and recovered people changed across the globe.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>temp <span style="color:#f92672">&lt;-</span> dat <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">group_by</span>(Date) <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">summarise</span>(Confirmed <span style="color:#f92672">=</span> <span style="color:#a6e22e">sum</span>(Confirmed), Deaths <span style="color:#f92672">=</span> <span style="color:#a6e22e">sum</span>(Deaths), Recovered <span style="color:#f92672">=</span> <span style="color:#a6e22e">sum</span>(Recovered)) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">gather</span>(key <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Variable&#34;</span>, value <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Count&#34;</span>, <span style="color:#f92672">-</span>Date)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ggplot</span>(temp, <span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> Date, y <span style="color:#f92672">=</span> Count, color <span style="color:#f92672">=</span> Variable)) <span style="color:#f92672">+</span> <span style="color:#a6e22e">geom_line</span>(size <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>)
</span></span></code></pre></div><p><img src="./unnamed-chunk-6-1.png" alt=""></p>
<p>The situation is very severe, as the current trend in exponentially increasing in terms of confirmed cases, and the growth rate of recovered is sufficiently slow. If we particular focus on the situation of India, (after 1st March, 2020),</p>
<p><img src="unnamed-chunk-7-1.png" alt=""></p>
<p>As of now, there are very less number of recoveries, some deaths, and a lot of (about 400) affected people. We have also compiled how these changes occurs spatially in different countries. They are shown below.</p>
<p><img src="./confirmed-1.gif" alt=""></p>
<p><img src="./deaths-1.gif" alt=""></p>
<h1 id="sir-model-description">SIR Model Description</h1>
<p>The SIR model is one of the compartmental models in epidemiology which is used to mathematically model the spread of an infectious disease. This model was firstly introduced by William Ogilvy Kermack and A. G. McKendrick, and named as <strong>Kermack-McKendrick Model.</strong> However, with time, this model has obtained several variants, each being better than the one before.</p>
<p>SIR modelling starts with defining 3 different compartments, of states in which a person can be. The states are as follows:</p>
<div class="mermaid">
    graph LR
    S(Susceptible) --> I(Infected)
    I(Infected) --> R(Recovered / Removed)
</div>
<p><strong>Susceptibles</strong> are the general population, who is susceptible to get the disease from an infectious person. <strong>Infected</strong> state reperesents the persons who have the symptoms of the infection and is able to spread it. And finally, <strong>Recovered</strong> or <strong>Removed</strong> is the state when a person is recovered from the disease and gain immunity to it, or is dead. Let, $Y_t^S, Y_t^I, Y_t^R$ dentoes the number of people in these states respectively at the time $t$. The corresponding proportions are denoted by $\theta_t^S, \theta_t^I$ and $\theta_t^R$, where the proportion is defined as the number of people in a state divided by the total number of people, i.e. the population count. Note that, since these three states are assumed to be exhaustive, hence $Y_t^S + Y_t^I + Y_t^R = N$, where $N$ is the total population of the particular region under study.</p>
<p>The mathematical relations between these quantities are defined as follows:</p>
<p>$$
\begin{align}
\dfrac{d\theta_t^S}{dt} &amp; = -\beta \theta_t^S \theta_t^I\\\
&amp; \\\
\dfrac{d\theta_t^I}{dt} &amp; = \beta \theta_t^S \theta_t^I - \gamma \theta_t^I\\\
&amp; \\\
\dfrac{d\theta_t^R}{dt} &amp; = \gamma \theta_t^I\\\
\end{align}
$$</p>
<p>Note that, since $Y_t^S + Y_t^I + Y_t^R = N$, we have $\theta_t^S + \theta_t^I + \theta_t^R = 1$, which is constant. Hence, we must have,</p>
<p>$$ \dfrac{d\theta_t^S}{dt} + \dfrac{d\theta_t^I}{dt} + \dfrac{d\theta_t^R}{dt} = 0 $$</p>
<p>which is satisfied by the mathematical formulation. In this, $\beta, \gamma$ are unknown parameters which is to be estimated from the data.</p>
<p>These mathematical equations did not drop from the sky. Let us understand how these mathematical formula emerges from an intuitive points of view.</p>
<ol>
<li>
<p>We consider the third equation first. It models the change in the number of recovered people. Now, the change in the number (or proportion) of recovered people can occur only when an infectious person, gets treatment, which happens with rate $\gamma$, which can be interpreted as the recovery rate of an infectious person. Therefore, it changes by the amount $\gamma \theta_t^I$.</p>
</li>
<li>
<p>Now we consider the first equation. It models the change in the number of susceptible population. The change in susceptible population occurs, when an infectious person comes in contact with a susceptible person, and the infection spreads. Now, there are $Y_t^I Y_t^S$ many interactions possible, and each interaction would spread the virus with rate $\beta$ say. Considering proportions, we have the change being equal to $-\beta\theta_t^I\theta_t^S$, with the negative sign showing that number of susceptibles can only decrease.</p>
</li>
<li>
<p>Due to the restriction, $\dfrac{d\theta_t^S}{dt} + \dfrac{d\theta_t^I}{dt} + \dfrac{d\theta_t^R}{dt} = 0$, the choice of $\dfrac{d\theta_t^I}{dt}$ can be justfied from previous points.</p>
</li>
</ol>
<p>A very important measure in this model is the quantity;</p>
<p>$$R_0 = \dfrac{\beta}{\gamma}$$</p>
<p>This basically interprets as the average number of people an infectious person infects before recovering or dying. So, if $R_0 &lt; 1$, then an infectious person infects less than one person in average before recovering, which means the infection pandemic will eventually die out. Whereas, if $R_0 &gt; 1$, then an infectious person infects more than one person in average before recovering, hence the number of infected would increase exponentially and eventually all of the population will become infected.</p>
<h1 id="estimation-of-sir-model">Estimation of SIR Model</h1>
<p>There are two possible ways of estimation of the parameters of an SIR model.</p>
<ol>
<li>
<p>A deterministic estimation.</p>
</li>
<li>
<p>A stochastic estimation.</p>
</li>
</ol>
<p>A deterministic estimation does not require any other assumptions on the model parameters, as well as the data. It basically works simply on the basis of solution to the above differential equations. However, a stochastic estimation requires specifications of the distributional assumptions on the data, as well as model parameters. In this post, we are going to use only a deterministic setup of the model as explained in the mathematical formulation, nothing more.</p>
<p>For this reason, we shall use <a href="https://en.wikipedia.org/wiki/Runge%E2%80%93Kutta_methods">Runge Kutta methods</a> of numerically solving a system of differential equations, under some particular choice of the model parameters $\beta, \gamma$. However, as we solve the differential equations, we shall be able to obtain estimates $\hat{Y}_t^S, \hat{Y}_t^I$ and $\hat{Y}_t^R$. Then, we can use a Least Squares approach to solve this problem, to estimate $\beta, \gamma$ as;</p>
<p>$$
(\hat{\beta}, \hat{\gamma}) = \min_{\beta, \gamma} \sum_t \left[ \left(Y_t^S - \hat{Y}_t^S\right)^2 + \left(Y_t^I - \hat{Y}_t^I\right)^2 + \left(Y_t^R - \hat{Y}_t^R\right)^2 \right]
$$</p>
<p>To this end, we write the function <code>pred.SIR</code> and <code>LS.SIR</code> which performs the prediction given the initial value and parameters, and computes the value of the objective function written above by tallying it with the observed data.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>pred.SIR <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">function</span>(n_time, beta, gamma, init.theta) {
</span></span><span style="display:flex;"><span>    theta <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">matrix</span>(<span style="color:#ae81ff">0</span>, nrow <span style="color:#f92672">=</span> n_time, ncol <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>    theta[1, ] <span style="color:#f92672">&lt;-</span> init.theta <span style="color:#f92672">/</span> <span style="color:#a6e22e">sum</span>(init.theta)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">for </span>(t in <span style="color:#ae81ff">2</span><span style="color:#f92672">:</span>n_time) {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># for each time, create the Runge Kutta approximation</span>
</span></span><span style="display:flex;"><span>        Km <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">numeric</span>(<span style="color:#ae81ff">12</span>)   <span style="color:#75715e"># 12 coefficients are needed</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># computes coefficients of runge kutta</span>
</span></span><span style="display:flex;"><span>        Km[1] <span style="color:#f92672">&lt;-</span> <span style="color:#f92672">-</span> beta <span style="color:#f92672">*</span> theta[t<span style="color:#ae81ff">-1</span>,<span style="color:#ae81ff">1</span>] <span style="color:#f92672">*</span> theta[t<span style="color:#ae81ff">-1</span>,<span style="color:#ae81ff">2</span>]
</span></span><span style="display:flex;"><span>        Km[9] <span style="color:#f92672">&lt;-</span> gamma <span style="color:#f92672">*</span> theta[t<span style="color:#ae81ff">-1</span>,<span style="color:#ae81ff">2</span>]
</span></span><span style="display:flex;"><span>        Km[5] <span style="color:#f92672">&lt;-</span> <span style="color:#f92672">-</span>Km[1]<span style="color:#f92672">-</span>Km[9]
</span></span><span style="display:flex;"><span>        Km[2] <span style="color:#f92672">&lt;-</span> <span style="color:#f92672">-</span> beta <span style="color:#f92672">*</span> (theta[t<span style="color:#ae81ff">-1</span>,<span style="color:#ae81ff">1</span>]<span style="color:#f92672">+</span> <span style="color:#ae81ff">0.5</span><span style="color:#f92672">*</span>Km[1]) <span style="color:#f92672">*</span> (theta[t<span style="color:#ae81ff">-1</span>,<span style="color:#ae81ff">2</span>]<span style="color:#ae81ff">+0.5</span><span style="color:#f92672">*</span>Km[5])
</span></span><span style="display:flex;"><span>        Km[10] <span style="color:#f92672">&lt;-</span> gamma<span style="color:#f92672">*</span>(theta[t<span style="color:#ae81ff">-1</span>,<span style="color:#ae81ff">2</span>]<span style="color:#ae81ff">+0.5</span><span style="color:#f92672">*</span>Km[5])
</span></span><span style="display:flex;"><span>        Km[6] <span style="color:#f92672">&lt;-</span> <span style="color:#f92672">-</span>Km[2]<span style="color:#f92672">-</span>Km[10]
</span></span><span style="display:flex;"><span>        Km[3] <span style="color:#f92672">&lt;-</span> <span style="color:#f92672">-</span>beta<span style="color:#f92672">*</span>(theta[t<span style="color:#ae81ff">-1</span>,<span style="color:#ae81ff">1</span>]<span style="color:#ae81ff">+0.5</span><span style="color:#f92672">*</span>Km[2])<span style="color:#f92672">*</span>(theta[t<span style="color:#ae81ff">-1</span>,<span style="color:#ae81ff">2</span>]<span style="color:#ae81ff">+0.5</span><span style="color:#f92672">*</span>Km[6])
</span></span><span style="display:flex;"><span>        Km[11] <span style="color:#f92672">&lt;-</span> gamma<span style="color:#f92672">*</span>(theta[t<span style="color:#ae81ff">-1</span>,<span style="color:#ae81ff">2</span>]<span style="color:#ae81ff">+0.5</span><span style="color:#f92672">*</span>Km[6])
</span></span><span style="display:flex;"><span>        Km[7] <span style="color:#f92672">&lt;-</span> <span style="color:#f92672">-</span>Km[3]<span style="color:#f92672">-</span>Km[11]
</span></span><span style="display:flex;"><span>        Km[4] <span style="color:#f92672">&lt;-</span> <span style="color:#f92672">-</span>beta<span style="color:#f92672">*</span>(theta[t<span style="color:#ae81ff">-1</span>,<span style="color:#ae81ff">1</span>]<span style="color:#f92672">+</span>Km[3])<span style="color:#f92672">*</span>(theta[t<span style="color:#ae81ff">-1</span>,<span style="color:#ae81ff">2</span>]<span style="color:#f92672">+</span>Km[7])
</span></span><span style="display:flex;"><span>        Km[12] <span style="color:#f92672">&lt;-</span> gamma<span style="color:#f92672">*</span>(theta[t<span style="color:#ae81ff">-1</span>,<span style="color:#ae81ff">2</span>]<span style="color:#f92672">+</span>Km[7])
</span></span><span style="display:flex;"><span>        Km[8] <span style="color:#f92672">&lt;-</span> <span style="color:#f92672">-</span>Km[4]<span style="color:#f92672">-</span>Km[12]
</span></span><span style="display:flex;"><span>        innov.S <span style="color:#f92672">&lt;-</span> ( Km[1] <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span>Km[2] <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>Km[3] <span style="color:#f92672">+</span> Km[4])<span style="color:#f92672">/</span><span style="color:#ae81ff">6</span>
</span></span><span style="display:flex;"><span>        innov.I <span style="color:#f92672">&lt;-</span> ( Km[5] <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span>Km[6] <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>Km[7] <span style="color:#f92672">+</span> Km[8])<span style="color:#f92672">/</span><span style="color:#ae81ff">6</span>
</span></span><span style="display:flex;"><span>        innov.R <span style="color:#f92672">&lt;-</span> ( Km[9] <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span>Km[10] <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>Km[11] <span style="color:#f92672">+</span> Km[12])<span style="color:#f92672">/</span><span style="color:#ae81ff">6</span>
</span></span><span style="display:flex;"><span>        theta[t, ] <span style="color:#f92672">&lt;-</span> theta<span style="color:#a6e22e">[</span>(t<span style="color:#ae81ff">-1</span>), ] <span style="color:#f92672">+</span> <span style="color:#a6e22e">c</span>(innov.S, innov.I, innov.R)
</span></span><span style="display:flex;"><span>        theta[t, ] <span style="color:#f92672">&lt;-</span> theta[t, ]<span style="color:#f92672">/</span><span style="color:#a6e22e">sum</span>(theta[t, ])
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">return</span>(theta)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>LS.SIR <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">function</span>(params, Y) {
</span></span><span style="display:flex;"><span>    beta <span style="color:#f92672">&lt;-</span> params[1]
</span></span><span style="display:flex;"><span>    gamma <span style="color:#f92672">&lt;-</span> params[2]
</span></span><span style="display:flex;"><span>    n_time <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">nrow</span>(Y)
</span></span><span style="display:flex;"><span>    N <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">sum</span>(Y[1, ])
</span></span><span style="display:flex;"><span>    init.theta <span style="color:#f92672">&lt;-</span> Y[1, ] <span style="color:#f92672">/</span> N
</span></span><span style="display:flex;"><span>    preds <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">pred.SIR</span>(n_time, beta, gamma, init.theta)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">return</span>( <span style="color:#a6e22e">sum</span>((Y <span style="color:#f92672">-</span> preds <span style="color:#f92672">*</span> N )^2) ) 
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h1 id="performance-of-sir-model">Performance of SIR model</h1>
<h2 id="estimation-for-hong-kong-china">Estimation for Hong Kong, China</h2>
<p>We choose the Hong Kong province in China to see how SIR model performs. According to World Bank data, the province Hong Kong is home to about $73.9$ lakhs people. Therefore, we have $N = 73.9\times 10^5$, in our model.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>N <span style="color:#f92672">&lt;-</span> <span style="color:#ae81ff">73.9e5</span>   <span style="color:#75715e"># population of Hong Kong</span>
</span></span><span style="display:flex;"><span>temp  <span style="color:#f92672">&lt;-</span> dat <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">filter</span>(Country <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;China&#34;</span> <span style="color:#f92672">&amp;</span> State <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;Hong Kong&#34;</span>) <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mutate</span>(Removed <span style="color:#f92672">=</span> Deaths <span style="color:#f92672">+</span> Recovered, Susceptible <span style="color:#f92672">=</span> N <span style="color:#f92672">-</span> Removed <span style="color:#f92672">-</span> Confirmed) <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">select</span>(Date, Susceptible, Confirmed, Removed)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>knitr<span style="color:#f92672">::</span><span style="color:#a6e22e">kable</span>(<span style="color:#a6e22e">head</span>(temp))
</span></span></code></pre></div><table>
<thead>
<tr>
<th>Date</th>
<th>Susceptible</th>
<th>Confirmed</th>
<th>Removed</th>
</tr>
</thead>
<tbody>
<tr>
<td>2020-01-22</td>
<td>7390000</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>2020-01-23</td>
<td>7389998</td>
<td>2</td>
<td>0</td>
</tr>
<tr>
<td>2020-01-24</td>
<td>7389998</td>
<td>2</td>
<td>0</td>
</tr>
<tr>
<td>2020-01-25</td>
<td>7389995</td>
<td>5</td>
<td>0</td>
</tr>
<tr>
<td>2020-01-26</td>
<td>7389992</td>
<td>8</td>
<td>0</td>
</tr>
<tr>
<td>2020-01-27</td>
<td>7389992</td>
<td>8</td>
<td>0</td>
</tr>
</tbody>
</table>
<p>As you can see, the first appearence of Coronavirus in Hong Kong is on 23rd of Janurary, 2020. So, we should use the data from 2nd row onwards to fit into SIR model. We shall be using the data corresponding to $61$ days, i.e. till 23rd of May, 2020. Among this, we shall be training the model using data of first $47$ days, and then we build the prediction for next $14$ days, to see the performance of the fitted model. We shall be using <code>optim</code> function of <code>R</code> to optimize our objective function in order to find Least Sqaures estimate.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>Y <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">as.matrix</span>(temp[2<span style="color:#f92672">:</span><span style="color:#ae81ff">48</span>, <span style="color:#ae81ff">2</span><span style="color:#f92672">:</span><span style="color:#ae81ff">4</span>])
</span></span><span style="display:flex;"><span>ops <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">optim</span>(par <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">1e-2</span>, <span style="color:#ae81ff">1e-5</span>), fn <span style="color:#f92672">=</span> LS.SIR, method <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;BFGS&#34;</span>, Y <span style="color:#f92672">=</span> Y, control <span style="color:#f92672">=</span> <span style="color:#a6e22e">list</span>(trace <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>))
</span></span></code></pre></div><pre tabindex="0"><code>initial  value 552556.538521 
iter  10 value 68951.183015
final  value 65031.692121 
converged
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>ops<span style="color:#f92672">$</span>par[1] <span style="color:#f92672">/</span> ops<span style="color:#f92672">$</span>par[2]   <span style="color:#75715e"># R0</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] 3.149289
</code></pre><p>Now that we have the estimated parameters, we can simply generate predictions for last $14$ days, using this <code>pred.SIR</code> method. Before that, estimate of $R_0$ turns out to be higher than 1, thereby showing the seriousness of the COVID-19 epidemic situation.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e"># since predictions are proportions, we multiply with the population to get the count estimates</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>preds <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">pred.SIR</span>(<span style="color:#ae81ff">14</span>, ops<span style="color:#f92672">$</span>par[1], ops<span style="color:#f92672">$</span>par[2], <span style="color:#a6e22e">as.matrix</span>(temp[49, <span style="color:#ae81ff">2</span><span style="color:#f92672">:</span><span style="color:#ae81ff">4</span>])) <span style="color:#f92672">*</span> N
</span></span><span style="display:flex;"><span>pred.dat <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">tibble</span>(Date <span style="color:#f92672">=</span> temp<span style="color:#f92672">$</span>Date[49<span style="color:#f92672">:</span><span style="color:#ae81ff">62</span>], Pred.Confirmed <span style="color:#f92672">=</span> preds[, <span style="color:#ae81ff">2</span>], Pred.Removed <span style="color:#f92672">=</span> preds[, <span style="color:#ae81ff">3</span>])
</span></span><span style="display:flex;"><span>pred.dat <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">left_join</span>(temp, pred.dat, by <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Date&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Date&#34;</span>))  <span style="color:#75715e"># create a full dataset containing predicted data as well</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ggplot</span>( pred.dat , <span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> Date) ) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">geom_line</span>(<span style="color:#a6e22e">aes</span>(y <span style="color:#f92672">=</span> Confirmed), color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;black&#34;</span>, size <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">geom_line</span>(<span style="color:#a6e22e">aes</span>(y <span style="color:#f92672">=</span> Pred.Confirmed), color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;blue&#34;</span>, size <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, linetype <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;dashed&#34;</span>)
</span></span></code></pre></div><p><img src="./unnamed-chunk-12-1.png" alt=""></p>
<p>Therefore, we see that SIR model overestimates the true number by about $75$ people at the last day. Nevertheless, this is simple model, which performs fairly good. However, it would have been nice if we could give a confidence interval around that estimate.</p>
<h2 id="performance-for-india">Performance for India</h2>
<p>We perform the same exercise for India as well. For India, the population is huge (about $131$ crores) and there is lesser amount of data available, although the first confirmed case of COVID-19 was identified in 30th January, 2020. We have data on $54$ days, among which we shall use all the data before last week, and generate predictions for last week, to visualize its performance.</p>
<p>The $R_0$ coefficient turns out to be 12.4850813, which is severe as it is a lot more than $1$.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>preds <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">pred.SIR</span>(<span style="color:#ae81ff">7</span>, ops<span style="color:#f92672">$</span>par[1], ops<span style="color:#f92672">$</span>par[2], <span style="color:#a6e22e">as.matrix</span>(temp[48, <span style="color:#ae81ff">2</span><span style="color:#f92672">:</span><span style="color:#ae81ff">4</span>])) <span style="color:#f92672">*</span> N
</span></span><span style="display:flex;"><span>pred.dat <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">tibble</span>(Date <span style="color:#f92672">=</span> temp<span style="color:#f92672">$</span>Date[48<span style="color:#f92672">:</span><span style="color:#ae81ff">54</span>], Pred.Confirmed <span style="color:#f92672">=</span> preds[, <span style="color:#ae81ff">2</span>], Pred.Removed <span style="color:#f92672">=</span> preds[, <span style="color:#ae81ff">3</span>])
</span></span><span style="display:flex;"><span>pred.dat <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">left_join</span>(temp, pred.dat, by <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Date&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Date&#34;</span>))  <span style="color:#75715e"># create a full dataset containing predicted data as well</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ggplot</span>( pred.dat , <span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> Date) ) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">geom_line</span>(<span style="color:#a6e22e">aes</span>(y <span style="color:#f92672">=</span> Confirmed), color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;black&#34;</span>, size <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">geom_line</span>(<span style="color:#a6e22e">aes</span>(y <span style="color:#f92672">=</span> Pred.Confirmed), color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;blue&#34;</span>, size <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, linetype <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;dashed&#34;</span>)
</span></span></code></pre></div><p><img src="./unnamed-chunk-14-1.png" alt=""></p>
<p>Yet in this case, the SIR model does a underestimation in determining the number of confirmed cases by about $100$ cases. Therefore, the seriousness of the pandemic situation is even worse than what is depicted by the number $R_0$, i.e. 12.4850813, it is enitrely possible that the true $R_0$ value is even more at the last week, thereby showing on average an infectious person is infecting more than $12$ persons, which is bad, seriously bad.</p>
<h2 id="predictions-till-the-end-of-the-lockdown">Predictions till the end of the Lockdown</h2>
<p>To make this prediction, we use all the available datapoints for estimation of the parameters. So, we refit the model.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>Y <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">as.matrix</span>(temp[, <span style="color:#ae81ff">2</span><span style="color:#f92672">:</span><span style="color:#ae81ff">4</span>])
</span></span><span style="display:flex;"><span>ops <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">optim</span>(par <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">1e-2</span>, <span style="color:#ae81ff">1e-5</span>), fn <span style="color:#f92672">=</span> LS.SIR, method <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;BFGS&#34;</span>, Y <span style="color:#f92672">=</span> Y)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>preds <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">pred.SIR</span>(<span style="color:#ae81ff">22</span>, ops<span style="color:#f92672">$</span>par[1], ops<span style="color:#f92672">$</span>par[2], <span style="color:#a6e22e">as.matrix</span>(temp[54, <span style="color:#ae81ff">2</span><span style="color:#f92672">:</span><span style="color:#ae81ff">4</span>])) <span style="color:#f92672">*</span> N
</span></span><span style="display:flex;"><span>pred.dat <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">tibble</span>(Date <span style="color:#f92672">=</span> temp<span style="color:#f92672">$</span>Date[54] <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">22</span>, 
</span></span><span style="display:flex;"><span>                   Pred.Confirmed <span style="color:#f92672">=</span> preds[, <span style="color:#ae81ff">2</span>], Pred.Removed <span style="color:#f92672">=</span> preds[, <span style="color:#ae81ff">3</span>])
</span></span><span style="display:flex;"><span>pred.dat <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">full_join</span>(temp, pred.dat, by <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Date&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Date&#34;</span>))  <span style="color:#75715e"># create a full dataset containing predicted data as well</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ggplot</span>( pred.dat , <span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> Date) ) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">geom_line</span>(<span style="color:#a6e22e">aes</span>(y <span style="color:#f92672">=</span> Confirmed), color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;black&#34;</span>, size <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">geom_line</span>(<span style="color:#a6e22e">aes</span>(y <span style="color:#f92672">=</span> Pred.Confirmed), color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;blue&#34;</span>, size <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, linetype <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;dashed&#34;</span>)
</span></span></code></pre></div><p><img src="./unnamed-chunk-15-1.png" alt=""></p>
<p>So, if there was no lockdown happening, the prediction of confirmed cases in India by middle of April would have be about $4000$.</p>
<h1 id="conclusion">Conclusion</h1>
<p>SIR is the simplest epidemiological model that captures the dyamics of the spread of an infectious disease. Note that, now the lockdowns and quanrantines are in place, therefore, it is expected that the different rates in the SIR model also becomes time varying. To capture this nature, we need to extend the SIR model to a slightly more complicated model, named <strong>eSIR</strong>. We shall talk about this in more detail in <a href="../covid19-eSIR-model/">part 2</a> of this post.</p>
<p><strong>WHO Guidelines to STAY SAFE:</strong></p>
<ul>
<li>
<p>The best way to prevent and slow down transmission is be well informed about the COVID-19 virus, the disease it causes and how it spreads.</p>
</li>
<li>
<p>Wash your hands frequently with an alcohol based rub or soap.</p>
</li>
<li>
<p>Maintain social distancing.</p>
</li>
<li>
<p>Avoid touching eyes, nose and mouth.</p>
</li>
<li>
<p>Practice respiratory hygiene.</p>
</li>
<li>
<p>If you have fever, cough and difficulty breathing, seek medical care early.</p>
</li>
<li>
<p>Stay informed and follow advice given by your healthcare provider.</p>
</li>
<li>
<p>Protect yourselves and protect others.</p>
</li>
</ul>

                </div>
            </div>
        </div>
    </div>
</div>



<div class="my-6 max-w-6xl md:mx-auto mx-4 text-center">
    <p class="italic text-lg font-semibold my-4">Explore more posts like this</p>
    <div class="flex flex-row justify-center gap-4">
        
        
            <a href="/posts/covid19-esir-model/" class="px-6 py-2 bg-blue-800 text-white hover:bg-neutral-900
             focus:bg-neutral-900 transition-all ease-in-out rounded-md shadow-sm">
                Next Post
            </a>
        
    </div>
    <div class="flex flex-row justify-center gap-4 my-4">
        <a href="/posts/" 
            class="px-6 py-2 bg-blue-800 text-white hover:bg-neutral-900 focus:bg-neutral-900 
                transition-all ease-in-out rounded-md shadow-sm">
            See all posts
        </a>
    </div>
</div>


<div class="my-6 max-w-6xl md:mx-auto mx-4">
    <div id="disqus_thread"></div>
<script type="application/javascript">
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "statwizard" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>



        </div>

        
<footer class="bg-neutral-900 text-center text-white">
    
    <div class="text-center px-0 py-4 w-full" style="background-color: rgba(0, 0, 0, 0.2)">
        © 2023 Copyright:
        <a class="text-white" href="/">StatWizard.in</a>
    </div>
</footer>

    </div>

    <script>
    $(document).ready(() => {

        
        $('#mobile-menu-button').click(() => {
            $('#mobile-menu').toggleClass('hidden');
            $('#mobile-menu-close-icon').toggleClass('hidden');
            $('#mobile-menu-close-icon').toggleClass('block');
            $('#mobile-menu-open-icon').toggleClass('hidden');
            $('#mobile-menu-open-icon').toggleClass('block');
        });

    });
</script>
<script type="module">
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';
    mermaid.initialize({ startOnLoad: true, securityLevel: "loose" });
</script>

     
</body>
</html>